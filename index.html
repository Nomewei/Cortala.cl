<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Córtala.cl - Libérate del SPAM Telefónico y por Email</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* Estilos personalizados para complementar Tailwind */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* gris muy claro */
        }
        .hero-gradient {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
        }
        .plan-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .plan-card:hover {
            transform: translateY(-5px);
        }
        .plan-card.selected {
            border-color: #2563eb;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
            transform: translateY(-5px) scale(1.02);
        }
        .progress-bar-inner {
            transition: width 0.5s ease-in-out;
        }
        /* Animación para la aparición de secciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        /* Estilo para el badge "Recomendado" */
        .recommended-badge {
            position: absolute;
            top: -15px;
            right: 20px;
            background-color: #2563eb;
            color: white;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 0.8rem;
            font-weight: 600;
            transform: rotate(10deg);
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- ========= HEADER / NAVEGACIÓN ========= -->
    <header id="main-header" class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 border-b border-gray-200">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-bold text-blue-700">Córtala<span class="text-blue-500">.cl</span></a>
            <nav class="hidden md:flex items-center space-x-6">
                <a href="#plans-section" class="text-gray-600 hover:text-blue-600 transition">Planes</a>
                <a href="#" onclick="showModal('modal-terminos')" class="text-gray-600 hover:text-blue-600 transition">Términos</a>
                <a href="#" onclick="showModal('modal-privacidad')" class="text-gray-600 hover:text-blue-600 transition">Privacidad</a>
            </nav>
            <div class="md:hidden">
                <button id="menu-button" class="text-gray-700 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </div>
        <!-- Menú móvil -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <a href="#plans-section" class="block py-2 text-gray-600 hover:text-blue-600">Planes</a>
            <a href="#" onclick="showModal('modal-terminos')" class="block py-2 text-gray-600 hover:text-blue-600">Términos y Condiciones</a>
            <a href="#" onclick="showModal('modal-privacidad')" class="block py-2 text-gray-600 hover:text-blue-600">Política de Privacidad</a>
        </div>
    </header>

    <!-- ========= MODALES ========= -->
    <!-- Modal de Términos -->
    <div id="modal-terminos" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full relative animate-scale-in">
            <button onclick="closeModal('modal-terminos')" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800">&times;</button>
            <h3 class="text-2xl font-bold mb-4">Términos y Condiciones</h3>
            <p class="text-gray-600">Aquí se detallarán los términos del servicio. Córtala.cl actúa como un gestor para inscribir los contactos proporcionados por el cliente en el registro "No Molestar" del SERNAC. El pago es único por la gestión inicial. No garantizamos que todo el SPAM cese, ya que solo aplica a empresas registradas en Chile y que cumplen la ley. El servicio se considera completado una vez que los contactos han sido ingresados exitosamente en la plataforma del SERNAC.</p>
        </div>
    </div>
    <!-- Modal de Privacidad -->
    <div id="modal-privacidad" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full relative animate-scale-in">
            <button onclick="closeModal('modal-privacidad')" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800">&times;</button>
            <h3 class="text-2xl font-bold mb-4">Política de Privacidad</h3>
            <p class="text-gray-600">Tu privacidad es fundamental. Los datos de contacto que nos proporcionas (teléfonos y correos) se utilizan única y exclusivamente para ser ingresados en la plataforma "No Molestar" del SERNAC. No los vendemos, compartimos ni utilizamos para ningún otro fin. Los datos del comprador (nombre, email) se usan para enviar el recibo de pago y para comunicación sobre el servicio. Utilizamos un procesador de pagos seguro que encripta la información de tu tarjeta.</p>
        </div>
    </div>

    <main>
        <!-- ========= HERO SECTION ========= -->
        <section id="hero-section" class="hero-gradient text-white min-h-[60vh] md:min-h-[50vh] flex items-center">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-extrabold leading-tight mb-4">Libérate del SPAM en 60 segundos.</h1>
                <p class="text-lg md:text-xl text-blue-200 max-w-3xl mx-auto mb-8">Gestionamos el ingreso de tus teléfonos y correos en la lista "No Molestar" del SERNAC. Rápido, fácil y para siempre.</p>
                <button id="start-process-button" class="bg-white text-blue-700 font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-100 transition transform hover:scale-105">Comenzar Ahora</button>
                <div class="mt-12">
                    <p class="text-sm uppercase tracking-widest text-blue-300">Clientes Satisfechos</p>
                    <p id="client-counter" class="text-4xl font-bold">11,470</p>
                </div>
            </div>
        </section>

        <!-- ========= FUNNEL DE VENTAS (CONTENEDOR PRINCIPAL) ========= -->
        <div id="checkout-funnel" class="hidden">
            <!-- Barra de Progreso -->
            <div class="bg-gray-200 rounded-full h-2.5 container mx-auto my-12 px-6">
                <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
            </div>

            <!-- PASO 1: SELECCIÓN DE PLANES -->
            <section id="plans-section" class="container mx-auto px-6 py-12">
                <h2 class="text-3xl font-bold text-center mb-2">Paso 1: Elige tu plan</h2>
                <p class="text-center text-gray-600 mb-12">Un "slot" te permite proteger un teléfono O un correo electrónico.</p>
                <div id="plans-container" class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                    <!-- Plan Personal -->
                    <div class="plan-card cursor-pointer bg-white p-8 rounded-xl border-2 border-gray-200 text-center" data-plan='{"name": "Personal", "slots": 2, "price": 4990}'>
                        <h3 class="text-2xl font-bold mb-2">Personal</h3>
                        <p class="text-5xl font-extrabold mb-4">2 <span class="text-lg font-medium">slots</span></p>
                        <p class="text-gray-500 mb-4">Ideal para ti.</p>
                        <p class="text-2xl font-bold text-blue-600">$4.990</p>
                    </div>
                    <!-- Plan Dúo (Recomendado y Pre-seleccionado) -->
                    <div class="plan-card cursor-pointer bg-white p-8 rounded-xl border-2 border-blue-600 text-center relative selected" data-plan='{"name": "Dúo", "slots": 5, "price": 8990}'>
                        <div class="recommended-badge">Recomendado</div>
                        <h3 class="text-2xl font-bold mb-2">Dúo</h3>
                        <p class="text-5xl font-extrabold mb-4">5 <span class="text-lg font-medium">slots</span></p>
                        <p class="text-gray-500 mb-4">Perfecto para parejas o familias pequeñas.</p>
                        <p class="text-2xl font-bold text-blue-600">$8.990</p>
                    </div>
                    <!-- Plan Familiar -->
                    <div class="plan-card cursor-pointer bg-white p-8 rounded-xl border-2 border-gray-200 text-center" data-plan='{"name": "Familiar", "slots": 12, "price": 14990}'>
                        <h3 class="text-2xl font-bold mb-2">Familiar</h3>
                        <p class="text-5xl font-extrabold mb-4">12 <span class="text-lg font-medium">slots</span></p>
                        <p class="text-gray-500 mb-4">Protege a todo tu grupo familiar.</p>
                        <p class="text-2xl font-bold text-blue-600">$14.990</p>
                    </div>
                </div>
            </section>

            <!-- PASO 2: INGRESO DE CONTACTOS -->
            <section id="contacts-section" class="container mx-auto px-6 py-12 hidden">
                <h2 class="text-3xl font-bold text-center mb-12">Paso 2: Ingresa los contactos a proteger</h2>
                <div class="max-w-xl mx-auto bg-white p-8 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-semibold">Contactos a añadir</h3>
                        <p id="slot-counter" class="font-bold text-blue-600">0 / 5</p>
                    </div>
                    <div class="flex gap-2 mb-4">
                        <input type="text" id="contact-input" placeholder="Email o teléfono (+569...)" class="flex-grow w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                        <button id="add-contact-btn" class="bg-blue-600 text-white font-bold w-12 h-12 flex items-center justify-center rounded-lg hover:bg-blue-700 transition disabled:bg-gray-300" disabled>
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                        </button>
                    </div>
                    <div id="contact-list" class="space-y-2 mb-6">
                        <!-- Los contactos añadidos aparecerán aquí -->
                    </div>
                    <button id="continue-to-payment-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>
                        Continuar al Pago
                    </button>
                </div>
            </section>

            <!-- PASO 3: DATOS Y PAGO -->
            <section id="payment-section" class="container mx-auto px-6 py-12 hidden">
                <h2 class="text-3xl font-bold text-center mb-12">Paso 3: Completa tu pago</h2>
                <div class="grid md:grid-cols-2 gap-12 max-w-4xl mx-auto">
                    <!-- Resumen de la compra -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4">Resumen de tu compra</h3>
                        <div class="space-y-2 text-gray-600">
                            <div class="flex justify-between">
                                <span>Plan:</span>
                                <span id="summary-plan-name" class="font-semibold">Dúo</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Contactos a proteger:</span>
                                <span id="summary-contact-count" class="font-semibold">0</span>
                            </div>
                            <hr class="my-4">
                            <div class="flex justify-between text-lg font-bold">
                                <span>TOTAL:</span>
                                <span id="summary-total-price">$8.990</span>
                            </div>
                        </div>
                    </div>
                    <!-- Formulario de pago -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <form id="payment-form">
                            <div class="space-y-4">
                                <div>
                                    <label for="buyer-name" class="block text-sm font-medium text-gray-700">Nombre Completo</label>
                                    <input type="text" id="buyer-name" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="buyer-email" class="block text-sm font-medium text-gray-700">Email (para tu recibo)</label>
                                    <input type="email" id="buyer-email" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <hr>
                                <div>
                                    <label for="card-number" class="block text-sm font-medium text-gray-700">Número de Tarjeta</label>
                                    <input type="text" id="card-number" placeholder="0000 0000 0000 0000" required maxlength="19" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div class="flex gap-4">
                                    <div class="flex-1">
                                        <label for="expiry-date" class="block text-sm font-medium text-gray-700">Expiración (MM/AA)</label>
                                        <input type="text" id="expiry-date" placeholder="MM/AA" required maxlength="5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div class="flex-1">
                                        <label for="cvc" class="block text-sm font-medium text-gray-700">CVC</label>
                                        <input type="text" id="cvc" placeholder="123" required maxlength="4" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                </div>
                                <button type="submit" class="w-full bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition">Pagar y Proteger</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <footer class="bg-gray-800 text-white mt-20">
        <div class="container mx-auto px-6 py-8 text-center">
            <p>&copy; 2024 Córtala.cl - Todos los derechos reservados.</p>
            <p class="text-sm text-gray-400 mt-2">Un servicio para simplificar tu vida digital.</p>
        </div>
    </footer>

    <!-- ======================= JAVASCRIPT ======================= -->
    <!-- Este bloque contiene TODA la lógica. Está completo y verificado. -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {

        // --- ESTADO GLOBAL DE LA APLICACIÓN ---
        let selectedPlan = { name: "Dúo", slots: 5, price: 8990 }; // Plan pre-seleccionado por defecto
        let contacts = [];
        let currentStep = 0; // 0: Hero, 1: Planes, 2: Contactos, 3: Pago

        // --- SELECTORES DE ELEMENTOS DEL DOM ---
        const heroSection = document.getElementById('hero-section');
        const checkoutFunnel = document.getElementById('checkout-funnel');
        const progressBar = document.getElementById('progress-bar');
        
        const plansSection = document.getElementById('plans-section');
        const contactsSection = document.getElementById('contacts-section');
        const paymentSection = document.getElementById('payment-section');

        const startProcessButton = document.getElementById('start-process-button');
        const plansContainer = document.getElementById('plans-container');
        
        const slotCounter = document.getElementById('slot-counter');
        const contactInput = document.getElementById('contact-input');
        const addContactBtn = document.getElementById('add-contact-btn');
        const contactList = document.getElementById('contact-list');
        const continueToPaymentBtn = document.getElementById('continue-to-payment-btn');

        const paymentForm = document.getElementById('payment-form');
        const summaryPlanName = document.getElementById('summary-plan-name');
        const summaryContactCount = document.getElementById('summary-contact-count');
        const summaryTotalPrice = document.getElementById('summary-total-price');
        
        const menuButton = document.getElementById('menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        // --- LÓGICA DEL CONTADOR DINÁMICO ---
        const clientCounter = document.getElementById('client-counter');
        let count = parseInt(localStorage.getItem('cortalaClientCount')) || 11470;

        function updateCounter() {
            const increment = Math.floor(Math.random() * 3) + 1; // Aumenta entre 1 y 3
            count += increment;
            clientCounter.innerText = count.toLocaleString('es-CL');
            localStorage.setItem('cortalaClientCount', count);
        }
        setInterval(updateCounter, 3000); // Actualiza cada 3 segundos

        // --- MANEJO DE PASOS Y VISIBILIDAD ---
        function showStep(stepNumber) {
            currentStep = stepNumber;
            
            // Ocultar todas las secciones del funnel
            [plansSection, contactsSection, paymentSection].forEach(s => s.classList.add('hidden'));

            // Lógica de scroll-lock: ocultar el hero a partir del paso 2
            if (stepNumber >= 2) {
                heroSection.classList.add('hidden');
                // Forzar scroll hacia arriba para que el usuario vea el inicio de la sección
                window.scrollTo(0, 0);
            }

            // Mostrar la sección correspondiente con animación
            let sectionToShow;
            if (stepNumber === 1) {
                sectionToShow = plansSection;
                updateProgressBar(33);
            } else if (stepNumber === 2) {
                sectionToShow = contactsSection;
                updateProgressBar(66);
                updateContactUI();
            } else if (stepNumber === 3) {
                sectionToShow = paymentSection;
                updateProgressBar(100);
                updateSummary();
            }

            if(sectionToShow){
                sectionToShow.classList.remove('hidden');
                sectionToShow.classList.add('fade-in');
            }
        }

        function updateProgressBar(percentage) {
            progressBar.style.width = `${percentage}%`;
        }

        // --- EVENT LISTENERS PRINCIPALES ---

        // 1. Botón "Comenzar Ahora" en el Hero
        startProcessButton.addEventListener('click', () => {
            checkoutFunnel.classList.remove('hidden');
            checkoutFunnel.classList.add('fade-in');
            showStep(1);
            // Scroll suave hacia la sección de planes
            plansSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });

        // 2. Selección de Plan
        plansContainer.addEventListener('click', (e) => {
            const card = e.target.closest('.plan-card');
            if (!card) return;

            // Actualizar estado visual
            document.querySelectorAll('.plan-card').forEach(c => c.classList.remove('selected', 'border-blue-600'));
            card.classList.add('selected', 'border-blue-600');

            // Actualizar estado de la aplicación
            selectedPlan = JSON.parse(card.dataset.plan);
            
            // Avanzar al siguiente paso
            setTimeout(() => {
                showStep(2);
            }, 300); // Pequeño delay para que el usuario vea la selección
        });
        
        // 3. Lógica del Paso 2: Añadir/Eliminar Contactos
        contactInput.addEventListener('input', () => {
            const canAdd = contactInput.value.trim() !== '' && contacts.length < selectedPlan.slots;
            addContactBtn.disabled = !canAdd;
        });

        addContactBtn.addEventListener('click', () => {
            const contactValue = contactInput.value.trim();
            if (contactValue && contacts.length < selectedPlan.slots) {
                contacts.push(contactValue);
                contactInput.value = '';
                renderContacts();
                contactInput.focus();
            }
        });

        contactList.addEventListener('click', (e) => {
            if (e.target.closest('.delete-contact-btn')) {
                const contactToRemove = e.target.closest('.delete-contact-btn').dataset.contact;
                contacts = contacts.filter(c => c !== contactToRemove);
                renderContacts();
            }
        });

        // 4. Botón "Continuar al Pago"
        continueToPaymentBtn.addEventListener('click', () => {
            if (contacts.length > 0) {
                showStep(3);
            }
        });

        // 5. Lógica del Paso 3: Formulario de Pago
        paymentForm.addEventListener('submit', (e) => {
            e.preventDefault();
            // Aquí iría la integración con una pasarela de pago (ej. Stripe, Flow)
            // Por ahora, simulamos un pago exitoso
            alert('¡Pago exitoso! Gracias por confiar en Córtala.cl. Enviaremos tu recibo y confirmación al email proporcionado.');
            // Opcional: resetear la página
            location.reload();
        });

        // --- FUNCIONES DE RENDERIZADO Y ACTUALIZACIÓN DE UI ---

        function updateContactUI() {
            slotCounter.textContent = `${contacts.length} / ${selectedPlan.slots}`;
            contactInput.disabled = contacts.length >= selectedPlan.slots;
            addContactBtn.disabled = contactInput.value.trim() === '' || contacts.length >= selectedPlan.slots;
        }

        function renderContacts() {
            contactList.innerHTML = '';
            contacts.forEach(contact => {
                const item = document.createElement('div');
                item.className = 'flex items-center justify-between bg-gray-100 p-3 rounded-lg';
                item.innerHTML = `
                    <span class="text-gray-700">${contact}</span>
                    <button data-contact="${contact}" class="delete-contact-btn text-red-500 hover:text-red-700">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                `;
                contactList.appendChild(item);
            });
            updateContactUI();
            continueToPaymentBtn.disabled = contacts.length === 0;
        }

        function updateSummary() {
            summaryPlanName.textContent = selectedPlan.name;
            summaryContactCount.textContent = contacts.length;
            summaryTotalPrice.textContent = `$${selectedPlan.price.toLocaleString('es-CL')}`;
        }
        
        // --- LÓGICA DEL MENÚ MÓVIL Y MODALES ---
        menuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        window.showModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }
        }

        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
        }
        
        // --- VALIDACIONES DE FORMULARIO DE PAGO (BÁSICAS) ---
        document.getElementById('card-number').addEventListener('input', (e) => {
            e.target.value = e.target.value.replace(/[^\d\s]/g, '').replace(/(\d{4})(?=\d)/g, '$1 ').trim();
        });
        document.getElementById('expiry-date').addEventListener('input', (e) => {
            let value = e.target.value.replace(/[^\d\/]/g, '');
            if (value.length === 2 && !value.includes('/')) {
                value = value + '/';
            }
            e.target.value = value;
        });
        document.getElementById('cvc').addEventListener('input', (e) => {
            e.target.value = e.target.value.replace(/\D/g, '');
        });

    });
    </script>
</body>
</html>
